#include "StockStrategy.h"

namespace stockstrategy
{
    struct Info
    {
        Info(int p, int v) { pos = p; val = v; }
        int pos;
        int val;
    };

    struct  compar
    {
        bool operator()(const Info& a, const Info& b) const
        {
            return a.pos < b.pos;
        }
    };

    struct adjustInfo
    {
        adjustInfo(multimap<Info, Info, compar >::iterator p1, Info i):p(p1),info(i) { }
        multimap<Info, Info, compar >::iterator p;
        Info info;
    };

    int getAns(vector<int> &a)
    {
        multimap<int, int> valPosAscMap;
        multimap<int, int, greater<int>> valPosDescMap;
        vector<bool> flagV;
        for (size_t i = 0; i < a.size(); ++i)
        {
            valPosDescMap.insert(pair<int, int>{a[i], i});
            valPosAscMap.insert(pair<int, int>{a[i], i});
            flagV.push_back(false);
        }

        multimap<Info, Info, compar > sellBuyPair;
        for (auto itSell = valPosDescMap.begin(); itSell != valPosDescMap.end(); ++itSell)
        {
            if (flagV[itSell->second] == true)
                continue;
            for (auto itBuy = valPosAscMap.begin(); itBuy != valPosAscMap.end(); ++itBuy)
            {
                if (flagV[itBuy->second] == true || itBuy->second == itSell->second)
                    continue;
                if (itBuy->first >= itSell->first)
                    break;
                if (itSell->second > itBuy->second)
                {
                    sellBuyPair.insert(pair<Info, Info>{Info(itSell->second, itSell->first), Info(itBuy->second, itBuy->first)});
                    flagV[itSell->second] = true;
                    flagV[itBuy->second] = true;
                    valPosAscMap.erase(itBuy);
                    break;
                }
            }
        }

        for (auto itSell = valPosDescMap.begin(); itSell != valPosDescMap.end(); ++itSell)
        {
            if (flagV[itSell->second] == true)
                continue;          
            for (auto itBuy = valPosAscMap.begin(); itBuy != valPosAscMap.end(); ++itBuy)
            {
                if (flagV[itBuy->second] == true || itBuy->second == itSell->second)
                    continue;
                if (itBuy->first >= itSell->first)
                    break;
                bool find = false;
                if (itSell->second > itBuy->second)
                {
                    sellBuyPair.insert(pair<Info, Info>{Info(itSell->second, itSell->first), Info(itBuy->second, itBuy->first)});
                    flagV[itSell->second] = true;
                    flagV[itBuy->second] = true;
                    valPosAscMap.erase(itBuy);
                    find = true;
                    break;
                }
                bool needRetry = true;
                int retryPos = itBuy->second;
                int retryVal = itBuy->first;

                vector<adjustInfo> adjustVec;
                multimap<Info, Info, compar >::iterator p;
                while (needRetry)
                {
                    p = sellBuyPair.begin();
                    needRetry = false;
                
                    for (; p != sellBuyPair.end(); ++p)
                    {
                        if (p->second.pos < itSell->second && p->second.val < itSell->first
                            && p->first.pos > retryPos && p->first.val > retryVal)
                        {
                            int buyPos = p->second.pos;
                            int buyVal = p->second.val;
                            p->second.pos = retryPos;
                            p->second.val = retryVal;
                            flagV[itSell->second] = true;
                            flagV[itBuy->second] = true;
                            sellBuyPair.insert(pair<Info, Info>{Info(itSell->second, itSell->first), Info(buyPos, buyVal)});
                            valPosAscMap.erase(itBuy);
                            find = true;
                            break;
                        }
                        else if (p->second.pos < itSell->second && p->second.val < itSell->first
                            && p->first.pos > retryPos && p->first.val > retryVal)
                        {
                            int buyPos = p->second.pos;
                            int buyVal = p->second.val;
                            p->second.pos = retryPos;
                            p->second.val = retryVal;
                            flagV[itSell->second] = true;
                            flagV[itBuy->second] = true;
                            sellBuyPair.insert(pair<Info, Info>{Info(itSell->second, itSell->first), Info(buyPos, buyVal)});
                            valPosAscMap.erase(itBuy);
                            find = true;
                            break;
                        }
                        else if (p->second.pos < retryPos
                            && p->first.pos > retryPos && p->first.val > retryVal)
                        {
                            needRetry = true;
                            adjustVec.push_back(adjustInfo(p, Info(retryPos, retryVal)));
                            retryPos = p->second.pos;
                            retryVal = p->second.val;
                            break;
                        }
                    }
                }
                if (find)
                {
                    if (adjustVec.size() > 0)
                    {
                        for (auto adj : adjustVec)
                        {
                            adj.p->second.pos = adj.info.pos;
                            adj.p->second.val = adj.info.val;
                        }
                        adjustVec.clear();
                    }
                    break;
                }
            }
        }
        int income = 0;

        for (auto p : sellBuyPair)
        {
            income += p.first.val - p.second.val;
        }
        return income;
    }

    void Test()
    {
        vector<int> a = {16,40,33,43,87,26,22,100,53,38,72,40,82,19,25,52,3,83};    // 375
        vector<int> a1 = { 29,52,12,51,8,38,77,10,54,90,26,8,13,97,40,96,87,80 };   // 500
        vector<int> a2 = { 46,65,42,4,80,84,53,53,100,45,76,55,73,31,30,54,39,15,96,24,74,12,58,19,
            47,86,2,30,41,88,100,65,18,8,70,28,63,79,52,62,87,64,10,62,78,89,5,93,61,91,92,61,86,9,100,
            62,6,100,66,16,13,69,7,4,5,23,4,30,85,35,44,78,36,94,22,25,58,42,79,14,90,79,75 }; //2065
        vector<int> a3 = {774,550,741,495,458,198,629,994,850,424,367,713,88,624,675,955,189,340,255,182,659,174,126,136,505,745,578,656,927,185,629,878,309,568,94,680,240,15,938,839,653,674,849,586,512,87,842,657,351,40,650,212,394,663,969,564,454,26,941,562,283,455,131,480,595,121,795,181,372,819,396,349,879,28,904,303,321,796,785,353,570,215,748,353,573,496,837,517,495,343,563,590,140,790,197,40,758,248,773,565,647,195,140,162,569,935,382,586,547,455,887,850,383,376,135,206,586,384,250,858,692,697,563,410,745,638,674,973,279,701,803,464,592,750,537,136,578,251,906,754,422,24,461,638,982,980,242,201,98,832,425,434,693,800,837,992,83,240,338,377,526,105,973,574,705,116,651,109,348,239,877,191,681,717,978,188,375,818,277,603,741,368,969,311,801,699,594,134,642,324,893,331,218,956,147,727,288,951,171,835,277,267,542,417,798,81,374,420,761,627,529,509,883,7,954,232,905,155,585,774,646,409,740,595,429,461,270,819,311,933,15,585,278,416,693,480,747,842,745,238,621,783,829,614,164,93,380,924,781,264,874,142,54,272,670,449,885,397,61,578,780,766,266,775,223,638,434,797,241,592,884,994,628,765,321,677,959,692,640,565,93,297,606,536,332,248,940,318,899,251,553,564,672,179,393,109,264,756,646,614,728,645,974,720,36,534,693,828,846,425,357,314,553,934,164,923,910,162,733,376,903,384,624,938,234,924,638,435,513,771,520,244,159,102,432,969,453,617,178,490,207,943,780,11,64,264,316,263,261,630,625,248,984,564,396,922,916,8,328,585,361,322,96,135,224,325,296,203,377,255,856,223,858,148,388,712,116,711,838,884,289,59,424,774,48,198,837,877,204,999,24,375,393,226,655,264,113,234,841,103,654,791,813,883,657,200,821,225,547,178,51,482,937,809,99,11,885,335,689,924,787,723,212,301,241,403,92,973,219,469,496,870,790,978,219,158,659,356,879,271,86,906,122,817,119,105,9,693,408,198,778,85,625,489,774,75,961,180,543,440,974,997,87,310,103,743,553,104,191,288,59,784,580,78,996,945,17,123,746,310,649,883,472,682,646,940,822,394,425,830,761,440,546,274,437,289,337,119,304,841,318,299,552,453,999,751,160,826,248,598,831,796,760,664,449,634,281,202,859,400,696,960,273,44,302,549,226,581,518,82,574,89,608,646,942,879,661,621,182,716,468,291,407,537,477,915,167,692,467,963,85,918,119,354,919,694,419,558,134,180,628,479,477,632,829,376,46,644,239,791,406,703,837,986,618,132,959,956,698,442,877,400,628,525,462,974,316,661,505,132,234,61,237,799,205,855,20,562,535,550,829,309,793,244,946,722,233,397,415,980,584,835,149,945,777,475,845,114,927,281,208,56,526,112,495,937,492,740,727,67,849,843,575,792,774,857,965,795,250,363,245,587,987,119,195,125,283,546,740,782,992,26,376,905,168,741,211,966,388,568,228,244,285,989,45,800,397,127,956,598,528,512,665,784,610,374,897,421,290,889,274,323,63,664,129,48,322,36,544,61,485,756,4,5,370,899,390,300,719,775,328,707,688,539,10,451,934,816,405,872,174,943,393,793,773,27,322,876,3,533,544,343,453,15,111,749,256,236,883,365,411,815,384,793,980,356,506,646,285,189,609,543,936,294,695,119,993,851,780,38,460,520,841,268,742,424,500,436,328,346,684,779,385,865,238,17,579,323,495,294,770,373,595,753,272,45,133,101,748,400,367,438,563,197,188,3,344,129,933,515,129,20,305,661,402,140,200,562,358,17,906,270,34,776,491,847,340,980,546,485,996,538,147,307,419,516,761,820,865,337,904,226,363,266,610,75,765,152,392,637,883,996,323,12,343,711,395,193,694,331,592,117,619,729,687,366,289,109,16,937,387,391,110,833,198,844,118,958,554,548,828,474,348,501,914,208,664,16,674,718,813,314,349,21,969,270,61,590,135,824,833,903,373,701,287,390,731,194,935,886,697,274,100,864,713,988,734,347,117,900,895,71,874,361,483,630,477,519,75,516,540,262,211,985,528,506,906,676,449,436,51,378,667,641,2,551,256,130,960,165,63,404,899,459,747,352,544,247,655,974,274,703,320,933,735,549,403,878,641,793,537,210,43,827,711,257,60,377,795,581,353,197,709,398,494,347,930,383,668,353,559,889,938,200,988,335,645,139,326,489,202,334,409,837,142,728,926,98,844,899,2,679,94,460,39,588,527,222,919,999,649,532,254,194,851,847,679,642,997,172,705,843,38,682,572,83,934,826,415,741,352,472,779,206,186,305,350,509,280,597,833,726,629,543,418,576,532,275,225,552,503,240,493,509,797,245,527,469,121,897,130,288,625,237,888,468,516,29,249,296,303,776,256,774,874,323,510,858,774,604,923,904,994,806,185,189,167,689,172,428,528,732,799,980,670,61,857,912,859,799,656,919,886,318,932,333,230,679,527,930,570,748,460,57,887,510,358,348,572,235,866,142,563,155,463,121,465,670,836,737,40,960,499,177,586,39,534,813,738,292,319,279,413,408,220,53,23,634,594,123,635,62,361,245,290,239,241,384,792,208,907,593,843,960,323,702,398,316,429,68,949,18,741,457,306,547,515,379,287,559,95,408,789,208,106,815,893,160,493,967,636,684,381,343,100,190,679,726,353,781,145,404,145,888,962,616,216,379,586,507,226,152,301,5,898,433,243,150,907,965,964,976,717,826,427,299,531,147,968,545,986,89,674,876,652,38,997,508,150,912,600,893,503,379,34,240,98,522,847,761,221,647,637,273,259,153,444,757,743,270,597,823,498,921,401,219,919,13,102,181,549,179,422,137,901,312,592,811,29,283,611,376,611,606,344,628,222,442,760,461,929,640,822,520,433,981,406,619,282,997,149,51,893,236,307,359,789,272,119,476,530,83,233,939,973,809,462,872,69,796,95,603,169,440,907,964,999,996,927,243,965,117,251,134,630,394,975,359,423,147,69,133,482,243,800,74,555,472,142,132,1,272,402,360,895,799,733,548,444,950,438,243,8,606,903,743,712,525,74,154,947,768,676,437,733,946,97,389,724,148,384,442,722,718,256,586,427,716,419,30,215,388,34,683,570,103,73,788,826,991,645,742,856,72,251,180,867,329,835,708,738,565,964,129,904,309,697,658,668,136,933,235,802,342,276,843,4,657,346,550,629,942,727,804,232,170,651,754,972,320,886,71,435,322,971,353,723,174,462,329,948,339,20,284,891,635,114,755,174,956,81,70,817,786,216,5,577,351,43,79,871,406,586,430,312,196,37,874,90,768,910,405,641,780,271,735,443,116,734,132,904,95,182,827,54,492,473,687,980,239,139,211,126,27,664,257,680,602,640,52,190,267,634,72,548,92,286,606,153,889,712,668,66,43,170,524,508,747,553,716,881,169,195,38,567,953,543,705,277,829,270,775,407,409,384,264,52,10,978,120,919,616,551,972,187,943,268,307,546,800,904,330,376,813,548,744,995,973,343,908,421,109,726,604,629,720,74,135,427,447,106,492,211,452,219,405,148,579,620,79,578,923,439,59,912,556,77,881,945,370,113,683,785,545,120,857,16,448,847,284,527,186,670,844,166,571,308,541,717,145,75,879,978,411,461,110,290,886,206,370,459,981,524,63,465,649,877,223,696,634,472,526,634,956,519,823,192,710,411,638,246,471,328,45,395,49,506,371,198,930,208,121,311,137,16,831,605,574,964,991,764,877,180,895,74,821,44,213,201,92,742,934,207,261,155,512,676,180,735,17,444,529,594,488,783,492,118,682,5,112,661,511,357,267,363,102,831,324,949,94,841,198,984,887,495,932,572,816,175,173,770,370,652,91,724,581,889,654,125,530,352,230,561,968,811,913,342,611,779,810,482,914,495,603,206,400,288,468,980,325,514,652,166,965,405,735,735,650,381,560,957,38,151,769,31,147,502,721,667,334,372,102,204,185,284,836,178,57,952,332,18,471,286,264,400,90,801,685,378,237,517,402,231,781,794,977,751,663,5,83,980,863,420,897,450,19,832,216,131,729,672,324,407,54,819,449,114,714,894,342,877,256,519,395,722,89,329,508,250,963,170,719,921,310,153,762,405,360,731,624,690,434,288,422,410,171,945,904,875,251,789,746,305,450,885,12,670,969,84,661,63,97,43,67,57,700,620,210,795,985,381,428,406,171,991,8,371,52,464,349,483,870,14,344,45,859,77,284,475,877,114,370,38,944,945,362,580,39,756,625,894,500,77,251,759,156,558,570,178,226,983,295,363,187,912,225,25,658,832,732,466,557,989,980,104,448,700,394,682,784,619,30,518,346,693,45,461,53,190,309,496,822,775,743,402,731,717,348,718,89,85,668,666,361,467,242,195,385,867,676,412,608,615,857,561,332,299,484,81,511,669,760,68,566,384,252,880,316,547,850,906,991,814,427,492,930,125,781,98,435,976,743,585,397,41,947,697,328,472,29,418,856,899,404,950,484,626,871,542,672,875,42,456,500,961,369,590,814,194,396,138,270,57,227,873,257,777,548,678,272,755,707,433,633,674,361,511,966,749,976,59,741,757,341,469,657,439,111,234,86,260,528,189,234,879,178,645,970,127,11,566,467,734,260,244,138,601,390,358,6,808,662,263,685,672,571,203,260,200,61,696,195,25,488,666,431,250,506,732,74,442,633,203,48,959,992,437,580,479,124,251,123,61,50,915,646,918,963,617,246,396,650,102,643,546,534,601,102,410,843,590,784,500,582,740,217,183,696,524,381,389,138,422,741,266,587,238,682,445,390,519,383,450,567,46,312,767,23,499,549,102,382,676,67,659,201,642,541,734,724,175,719,371,649,952,579,920,442,848,368,558,363,566,504,756,292,816,600,984,29,711,445,343,571,533,37,168,938,684,884,372,915,992,680,512,745,464,959,254,574,826,424,681,339,885,39,976,328,90,589,381,424,901,991,118,345,241,557,627,418,418,246,361,670,271,338,558,689,895,32,774,968,875,90,358,109,220,254,743,435,246,574,725,327,510,753,145,736,968,475,755,673,245,923,700,644,234,980,835,617,724,14,950,631,699,518,484,410,92,11,193,398,124,66,673,195,57,669,648,498,115,551,394,374,339,811,430,750,35,110,792,842,975,490,992,828,394,380,77,618,100,240,197,793,186,563,769,428,374,970,125,172,241,297,734,834,422,406,255,227,985,144,301,316,752,874,377,615,217,260,39,212,620,699,365,451,594,472,373,760,302,951,734,561,835,905,392,772,294,500,687,500,93,17,282,630,472,647,556,839,887,958,859,385,573,286,575,997,971,185,501,874,296,814,212,23,79,783,264,781,66,254,438,625,62,115,543,785,790,425,712,837,821,258,448,200,494,656,140,78,334,78,288,856,52,286,495,406,87,324,437,397,858,658,491,73,988,269,547,652,515,817,300,736,289,393,768,361,159,369,180,831,626,439,456,899,883,463,255,351,363,366,817,27,638,538,567,181,199,760,807,48,925,637,746,921,333,41,433,750,192,281,783,183,487,308,611,138,107,505,436,522,410,431,962,487,151,548,355,4,648,850,491,661,150,927,208,567,849,635,413,581,994,616,772,624,21,941,250,582,127,172,181,838,588,557,17,467,988,946,812,623,750,20,655,818,862,629,350,107,963,752,330,550,276,126,940,359,421,507,684,646,652,56,676,12,721,465,782,828,749,50,869,677,82,430,707,255,275,753,110,533,965,487,856,458,831,699,888,158,646,692,651,387,172,581,303,11,330,324,873,77,115,550,725,295,682,225,870,118,919,137,855,324,303,383,89,745,458,823,645,277,280,97,701,36,254,771,719,596,325,517,330,123,309,429,779,397,216,763,561,188,401,223,760,984,887,666,243,258,805,515,750,531,140,307,43,162,242,714,315,550,853,411,8,521,867,38,472,158,580,622,780,660,338,282,666,810,791,79,352,22,296,157,778,761,665,120,237,45,329,99,221,914,911,56,652,461,869,563,212,314,60,288,879,828,193,418,221,354,782,741,334,932,668,502,968,526,759,786,963,836,714,212,299,752,501,251,894,775,708,251,143,554,410,771,866,468,206,799,41,728,21,830,534,757,736,63,601,715,487,535,253,96,678,407,918,919,14,708,718,9,87,182,144,198,542,757,332,157,930,729,245,994,899,433,575,976,324,22,461,240,608,513,26,24,811,866,182,527,771,891,691,504,255,340,369,214,294,152,759,719,459,808,922,315,200,318,739,174,105,557,300,500,578,615,555,461,251,375,931,482,555,944,39,854,771,701,936,200,436,75,209,313,740,468,433,337,636,773,192,343,758,282,838,688,478,953,1000,422,445,780,277,941,774,995,872,451,739,377,470,479,431,862,403,739,722,277,336,732,384,766,455,882,347,807,602,19,850,319,873,28,850,67,299,91,68,620,351,935,575,81,99,625,904,529,413,511,671,563,999,198,11,482,632,295,641,643,553,734,705,489,38,111,305,515,46,906,238,611,60,513,240,587,383,542,174,844,430,706,162,327,456,988,782,319,483,567,22,598,923,328,904,455,246,838,658,236,374,850,11,209,935,569,541,736,225,623,721,255,767,119,851,327,777,313,655,894,656,18,189,79,680,626,545,889,371,554,302,941,803,716,276,404,263,664,526,505,658,516,489,194,321,180,403,692,540,706,752,503,846,376,843,96,296,403,651,447,403,778,708,176,661,248,151,333,221,462,324,164,58,196,47,541,410,657,561,151,519,730,121,195,406,775,306,184,443,996,407,233,919,599,660,316,475,285,382,653,106,802,910,819,465,128,962,624,938,799,381,494,763,199,969,928,576,762,137,551,832,765,923,335,150,352,950,106,46,388,177,466,796,165,732,476,727,800,427,523,163,726,464,115,55,417,503,952,180,751,745,934,912,93,9,58,682,710,755,816,910,676,670,558,59,438,623,369,124,954,96,999,996,661,721,237,685,553,790,890,930,334,80,667,99,621,401,848,449,984,954,855,803,758,391,696,321,150,422,169,207,665,251,258,932,309,72,147,371,959,587,117,889,977,408,919,545,780,993,442,44,199,811,695,269,801,99,631,284,468,49,75,33,723,940,494,356,941,590,735,178,314,888,995,475,317,769,458,441,27,379,257,875,947,135,640,283,462,715,29,845,969,201,657,858,481,65,113,772,774,49,24,66,787,541,795,526,869,282,117,181,73,847,924,774,531,973,827,631,957,318,305,252,869,653,778,746,778,996,973,267,664,844,30,803,105,856,5,698,550,379,326,427,423,843,522,389,128,526,526,759,989,684,555,105,559,957,670,192,15,29,144,587,874,908,673,356,253,843,633,537,691,268,119,44,605,977,349,255,553,232,771,692,55,518,859,356,303,513,629,966,79,618,148,58,540,723,705,967,470,901,831,938,26,238,822,168,634,552,916,797,799,613,728,118,442,218,745,844,7,498,87,570,419,917,488,433,207,312,174,842,789,895,503,916,395,120,133,438,87,337,950,255,729,197,631,764,159,347,957,66,748,631,236,477,970,237,116,744,595,12,496,694,266,847,465,144,583,58,347,464,563,491,397,61,616,894,79,328,309,390,223,798,249,481,405,967,229,123,432,215,295,5,920,739,980,479,821,342,246,972,287,588,686,102,648,927,372,626,200,544,949,533,183,776,868,622,752,215,180,742,820,654,540,717,524,928,36,671,51,654,215,631,683,427,570,955,775,988,84,88,25,813,694,119,462,16,373,944,270,743,366,958,112,988,969,420,221,183,25,230,156,575,427,578,790,565,117,760,138,502,713,361,116,343,185,420,898,725,405,183,784,733,52,563,356,34,399,160,524,926,636,428,350,723,993,670,1000,857,791,624,473,307,626,996,168,309,86,173,548,161,780,313,180,410,829,46,816,424,750,67,7,854,276,161,994,296,202,74,233,361,777,416,805,900,832,161,405,625,84,273,685,770,721,928,484,198,546,822,204,982,117,45,616,863,610,326,737,151,678,502,313,635,819,330,300,592,514,32,955,705,356,8,259,817,93,396,14,561,306,468,681,580,4,844,589,120,398,674,369,496,988,978,360,512,916,325,647,353,193,402,706,934,405,667,440,454,863,859,924,930,6,486,925,977,253,226,768,763,351,189,972,659,340,71,558,792,325,753,447,269,868,534,451,736,224,161,147,416,712,311,501,707,797,78,761,590,949,31,360,198,741,16,769,855,351,660,228,11,629,895,50,781,876,309,276,735,828,866,211,96,191,287,328,330,392,140,766,651,983,641,868,802,98,994,967,117,741,706,752,209,901,958,722,681,729,149,638,58,26,551,218,7,493,636,55,208,991,958,194,280,953,522,398,455,739,355,224,133,173,407,347,929,700,846,477,417,346,256,290,570,650,215,431,243,450,981,233,717,817,518,287,717,99,913,653,5,11,795,947,711,184,581,62,684,451,624,781,21,752,446,582,408,787,482,330,788,605,26,174,40,887,732,500,553,534,599,633,339,744,939,224,11,254,820,543,722,994,819,81,412,682,5,468,905,318,208,379,980,303,20,326,27,472,206,736,270,546,979,706,547,98,570,591,312,197,26,272,331,800,583,968,631,209,607,498,672,610,642,954,41,367,753,969,564,405,942,349,466,294,925,840,219,954,169,568,248,8,417,559,231,757,300,92,302,580,164,754,284,592,959,951,317,494,867,447,44,238,171,906,558,114,925,300,452,752,143,123,105,85,753,782,181,619,515,708,937,220,434,451,356,447,800,946,502,251,778,705,291,82,750,495,922,984,244,948,310,187,60,208,756,469,336,452,910,623,700,128,936,657,723,636,937,152,195,731,645,383,677,517,936,305,998,812,445,749,225,17,896,979,952,688,193,607,320,145,650,500,485,40,282,594,878,423,347,938,643,547,681,41,836,492,581,68,931,841,976,204,220,35,980,642,244,713,63,820,96,501,601,72,736,188,849,376,60,523,642,62,29,848,668,250,375,607,792,19,189,14,644,243,198,363,136,942,591,812,64,603,673,760,235,115,172,924,859,218,972,480,382,804,475,843,780,210,887,364,410,133,645,443,535,938,134,495,677,671,505,34,314,325,834,994,759,734,281,888,425,281,398,670,862,235,956,885,546,992,579,405,11,875,330,224,785,770,84,457,115,878,499,873,518,297,139,643,351,521,408,401,10,596,898,837,116,916,448,76,382,77,203,432,907,196,437,670,420,91,649,640,1,938,476,275,36,168,532,443,689,627,360,997,432,372,113,485,910,198,320,970,520,584,288,983,145,913,620,539,583,892,204,267,625,948,36,630,811,530,430,498,494,924,874,661,161,152,226,558,284,226,635,101,383,810,209,193,47,794,697,809,769,110,741,396,705,564,940,84,141,614,96,440,149,846,844,594,254,961,966,993,480,399,617,919,213,691,582,29,899,398,412,670,131,552,29,914,538,161,875,228,744,293,339,573,80,847,632,746,887,159,371,860,777,374,954,391,368,266,175,293,726,77,971,532,405,899,611,309,620,212,761,566,925,846,277,194,445,407,990,215,892,513,563,64,886,367,727,397,97,287,461,848,288,673,440,713,446,774,879,901,415,908,374,657,572,194,576,37,373,263,364,847,917,736,670,342,96,849,943,801,768,611,527,462,384,815,650,823,232,442,769,74,195,234,723,671,997,896,212,64,264,942,900,708,265,875,898,492,591,549,843,683,332,270,6,663,16,162,58,381,857,271,994,812,431,198,208,63,863,689,703,673,22,230,901,541,57,691,769,916,363,986,290,571,399,167,73,347,686,159,279,122,306,572,345,467,332,831,459,969,188,181,651,26,983,700,600,74,605,511,579,149,139,705,612,209,391,151,448,10,867,513,697,768,611,66,927,919,842,421,734,974,106,387,431,650,290,418,924,251,269,376,238,718,849,273,529,557,925,405,699,213,839,414,785,950,764,576,386,416,713,817,752,644,874,731,500,904,289,544,961,696,65,734,132,57,227,283,994,23,665,290,403,346,545,150,478,820,573,103,916,806,592,355,625,764,867,279,89,750,594,422,495,17,360,368,492,661,442,582,350,231,930,110,215,402,971,731,408,210,197,54,21,234,937,394,466,30,815,964,742,443,21,722,471,38,644,7,631,626,934,812,870,22,626,736,335,974,67,186,367,400,453,942,284,978,938,623,242,427,868,437,852,607,428,375,296,799,291,786,868,112,110,634,520,450,79,752,276,948,58,877,844,654,741,991,65,848,756,914,153,81,460,680,49,466,638,867,771,252,262,946,603,111,188,738,966,253,666,847,861,582,136,348,718,453,349,760,268,18,55,1,24,874,445,853,48,308,210,638,159,869,636,902,780,751,278,300,496,685,187,885,690,962,229,7,101,955,453,753,878,34,3,575,678,132,799,525,638,485,209,458,116,571,151,479,424,920,69,823,396,148,26,370,444,10,536,213,730,73,276,348,421,967,735,114,563,865,84,136,389,717,435,116,762,956,357,372,798,410,681,300,812,792,455,212,346,709,227,654,340,632,235,326,740,488,660,427,824,599,515,301,412,557,960,663,610,609,463,454,551,310,506,515,888,987,97,198,700,178,972,275,524,974,330,882,216,639,386,505,300,776,123,508,667,387,287,400,403,331,261,469,337,306,439,507,158,780,929,54,819,67,412,740,104,357,913,845,315,755,561,437,223,819,365,655,891,424,962,194,277,136,199,568,126,687,578,108,320,435,351,844,94,159,458,576,298,251,992,690,508,540,801,798,58,368,513,44,363,485,495,163,297,954,77,80,198,38,825,639,301,968,811,345,229,534,528,32,785,882,390,295,884,762,690,957,660,511,262,387,443,680,671,683,990,1000,278,436,375,541,981,748,422,307,412,437,240,640,468,147,174,617,357,948,2,789,619,769,813,784,358,269,268,27,242,459,508,866,843,477,331,518,189,570,930,364,380,175,152,989,168,450,696,111,955,811,574,821,645,651,997,707,967,913,821,301,695,147,235,431,932,986,210,47,795,266,537,499,289,720,604,693,250,28,583,166,905,449,784,122,400,275,389,784,378,488,862,181,24,730,716,257,289,84,770,114,341,787,347,288,836,711,13,697,842,994,460,333,279,841,665,324,412,104,788,895,927,266,928,877,723,681,654,351,546,835,317,230,413,574,161,291,605,357,569,7,274,716,646,844,268,368,560,892,785,627,226,744,142,694,938,732,257,31,218,937,222,406,466,507,865,627,474,516,996,42,314,1000,913,353,389,683,417,289,821,352,822,51,128,644,135,861,284,386,594,69,503,455,655,910,610,193,217,201,174,884,832,325,832,885,326,554,97,514,159,266,417,833,332,681,149,425,137,262,206,79,438,571,229,329,603,330,220,64,31,344,614,601,291,871,481,700,354,526,875,218,276,371,555,64,91,540,338,137,501,498,489,419,996,408,884,896,643,59,312,496,602,825,537,557,131,519,239,551,341,502,754,121,440,317,59,836,683,213,901,738,931,881,228,774,981,404,813,242,6,896,214,697,961,276,919,318,537,749,90,140,63,201,694,304,909,224,530,772,356,772,512,942,555,826,64,952,305,944,823,904,278,514,31,11,645,512,129,974,740,451,560,773,103,904,584,527,594,83,111,866,397,616,771,675,781,157,948,985,152,204,882,867,625,992,482,774,926,678,462,755,398,383,259,585,246,146,7,999,990,831,258,405,296,97,204,779,440,876,144,577,442,79,423,97,176,587,296,762,811,174,910,415,517,481,106,543,549,720,707,910,714,739,740,276,115,896,733,613,486,852,460,961,831,794,37,12,803,659,743,744,46,655,394,385,458,90,798,681,34,746,357,438,38,560,636,737,47,949,277,216,221,831,17,271,246,293,476,474,106,743,946,390,645,337,761,81,469,658,878,630,997,63,324,901,817,845,802,571,627,448,381,846,302,269,710,404,816,847,189,101,733,16,30,669,593,925,787,831,382,808,130,390,168,72,904,141,261,395,942,466,825,143,516,206,272,726,515,625,941,216,319,419,219,61,973,918,610,683,176,482,453,572,722,257,849,892,554,677,464,578,537,870,111,45,386,216,29,169,489,564,757,953,402,710,221,871,294,768,920,130,561,797,753,856,295,127,10,740,657,781,411,473,842,135,462,416,319,548,123,206,695,383,368,98,207,165,283,773,521,986,251,275,501,285,243,737,104,497,425,552,829,869,670,497,730,141,822,80,340,786,923,390,509,609,381,18,125,496,997,576,798,638,298,221,253,907,235,938,950,389,302,55,311,108,697,9,848,673,175,583,168,963,685,841,156,369,445,570,780,327,915,192,814,619,30,25,464,71,697,817,408,500,891,769,37,884,300,10,388,273,705,794,452,397,785,390,867,89,640,633,188,34,868,940,265,961,615,71,782,633,645,374,134,54,406,167,874,796,638,139,854,622,99,844,998,17,487,510,186,560,550,112,294,673,882,549,229,223,493,230,711,970,54,786,96,108,569,353,611,125,296,445,63,233,550,346,312,576,870,312,969,406,263,703,737,516,795,618,492,335,608,398,452,600,182,101,271,852,66,614,738,365,906,848,142,912,450,15,58,432,671,781,385,315,602,125,854,51,336,156,989,288,103,32,436,28,707,542,250,776,858,567,670,765,292,211,995,373,231,513,362,698,978,844,913,575,665,818,139,983,352,346,897,442,163,844,951,511,894,206,401,198,872,547,215,717,558,502,607,854,293,64,978,239,535,303,810,842,978,319,483,462,45,245,238,222,173,33,518,680,127,828,637,40,78,219,414,902,767,635,505,965,307,149,426,62,366,363,642,533,342,652,539,625,733,548,814,650,786,360,48,222,445,857,180,53,106,735,466,142,264,855,529,609,147,808,544,158,454,874,292,734,597,864,53,289,857,128,969,815,397,609,685,971,473,308,569,357,397,38,963,246,817,125,63,594,187,800,710,505,368,324,717,62,478,28,768,252,513,497,126,637,365,819,197,974,188,142,649,599,591,96,498,7,546,506,572,488,76,214,156,526,492,144,887,733,298,240,52,764,845,38,789,173,89,822,817,31,452,191,814,29,368,367,286,896,691,241,759,994,661,857,808,325,170,103,849,796,338,619,506,287,653,312,934,5,402,707,937,621,17,998,231,30,608,400,471,368,843,208,481,650,64,98,292,526,794,144,195,665,76,309,120,503,88,54,690,87,944,354,875,442,221,908,685,282,926,702,198,329,484,927,65,55,139,560,159,897,643,388,598,54,32,479,585,539,959,569,656,201,787,898,417,405,518,744,735,529,979,566,698,130,444,560,919,410,479,660,890,726,119,827,737,274,232,321,514,507,890,872,48,197,274,732,506,871,254,435,949,652,391,83,435,107,676,208,531,513,412,70,355,981,740,324,908,468,130,818,685,967,161,620,90,290,487,343,479,414,123,84,279,57,986,363,802,44,20,82,166,693,770,485,428,846,379,688,415,382,224,443,337,159,636,341,855,528,776,404,902,827,942,668,686,825,396,774,117,709,899,795,399,950,889,394,605,953,564,366,875,591,976,691,871,843,66,506,423,254,926,915,505,118,646,338,441,28,452,710,95,782,859,374,119,45,304,772,309,687,870,911,216,735,891,619,614,691,557,924,720,950,529,131,712,743,525,119,128,875,28,352,677,463,98,481,756,872,592,156,964,342,67,354,908,822,136,770,822,127,867,114,452,159,840,332,569,143,753,443,876,172,658,375,201,864,633,188,56,393,297,105,82,967,969,296,273,924,689,249,447,487,341,701,402,25,693,360,126,436,859,149,124,257,687,776,234,849,904,440,307,398,699,668,408,523,585,280,870,713,492,648,370,859,906,484,131,220,118,236,591,960,259,718,624,368,194,278,432,194,398,357,875,281,582,685,845,488,739,723,108,157,226,582,862,780,452,136,509,856,884,619,562,801,721,269,673,275,461,159,988,196,797,466,138,264,1,19,993,256,606,985,937,896,307,228,427,232,145,504,490,270,263,346,105,193,364,99,110,881,38,187,949,61,59,168,87,637,678,326,381,970,788,761,855,794,423,249,730,184,810,77,802,236,263,588,212,119,966,143,855,618,750,691,59,215,105,270,723,823,139,752,463,453,467,460,670,156,229,102,594,53,623,215,484,523,395,767,801,779,117,442,605,821,85,255,759,832,671,221,357,774,881,998,90,979,948,825,501,812,887,730,539,469,648,453,888,36,141,331,954,588,834,748,134,356,107,254,648,770,612,876,381,810,904,259,107,571,119,777,780,195,523,174,782,514,69,968,142,277,19,985,214,876,949,148,533,222,312,785,22,331,906,732,964,851,711,517,988,469,828,179,715,802,306,426,930,483,653,111,991,816,982,993,286,722,717,211,663,179,467,271,106,37,879,229,352,113,239,780,900,57,434,696,595,495,604,37,55,888,289,339,186,283,21,874,33,422,444,72,702,427,77,161,51,159,284,606,804,412,233,849,708,239,723,240,482,972,288,816,158,224,289,283,255,680,98,637,783,952,88,812,369,159,382,622,401,649,921,120,189,932,635,244,435,135,829,58,291,992,736,362,630,901,13,448,879,70,675,385,792,273,498,382,1000,469,126,919,469,139,246,826,389,153,429,44,33,777,545,574,707,683,290,532,327,78,477,514,672,652,186,175,709,327,106,679,404,982,21,268,653,781,67,493,131,924,33,121,382,950,942,86,964,236,799,205,33,595,48,568,405,156,333,391,413,203,464,167,468,690,818,212,820,639,79,992,383,619,669,605,827,116,54,63,373,909,383,822,693,276,216,803,851,141,788,672,176,741,243,557,697,954,703,784,295,529,331,140,498,287,227,342,103,260,727,620,791,861,594,774,714,393,587,354,100,71,265,147,967,766,236,361,297,892,898,575,264,715,455,857,299,737,401,44,642,743,163,506,617,244,23,550,665,203,890,230,551,170,138,271,913,12,123,340,630,530,595,666,678,141,275,238,762,911,855,912,37,211,752,652,99,650,232,126,272,872,204,78,381,798,593,988,838,969,400,54,528,418,492,160,345,736,431,787,568,51,223,865,343,458,166,88,725,663,51,733,961,321,267,491,612,379,780,268,263,803,987,774,669,14,252,722,538,410,682,113,244,764,944,688,8,794,503,23,832,772,513,932,852,455,629,396,815,169,588,405,867,900,388,645,47,533,578,503,456,756,909,768,166,721,889,885,945,213,210,72,299,527,921,234,455,552,731,666,563,257,640,879,490,395,226,755,429,95,607,448,227,583,112,176,951,964,203,983,225,922,318,723,319,777,317,16,516,182,901,813,50,865,602,499,205,568,14,759,664,115,747,525,140,913,179,167,525,828,230,303,616,345,52,874,626,275,475,69,171,359,51,988,243,746,568,96,707,450,80,25,375,611,678,189,946,988,582,984,667,17,122,652,278,586,684,826,270,299,908,50,250,13,749,984,422,253,675,760,388,59,944,794,34,430,280,225,789,495,680,505,926,531,462,935,604,268,373,294,75,266,400,103,979,358,378,768,412,336,491,368,872,786,174,482,121,484,936,904,278,337,419,482,632,506,876,240,377,697,401,92,479,889,703,627,814,756,979,181,348,13,160,58,872,847,993,608,197,821,535,523,948,636,933,845,728,142,954,982,310,857,934,980,164,479,73,814,369,550,712,238,678,667,490,990,99,66,746,869,133,786,165,170,495,727,639,695,935,703,257,601,810,482,957,591,658,947,965,650,190,68,553,60,395,745,328,116,426,788,361,368,346,321,722,956,775,394,377,474,515,54,152,794,981,757,646,733,263,503,412,604,980,318,670,479,802,529,491,875,652,803,422,82,27,203,302,481,877,869,570,566,278,425,441,281,87,850,457,317,133,258,343,711,676,292,814,894,747,898,299,35,505,120,865,395,984,808,736,906,48,136,300,227,880,113,426,805,553,841,270,200,891,84,259,721,69,662,555,186,390 };
        cout << "Income : " << getAns(a) << endl;
        cout << "Income : " << getAns(a1) << endl;
        cout << "Income : " << getAns(a2) << endl;
        cout << "Income : " << getAns(a3) << endl;
    }
}